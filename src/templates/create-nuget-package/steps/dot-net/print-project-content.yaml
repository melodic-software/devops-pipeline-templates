steps:
  - task: PowerShell@2
    name: PrintProjectContentDotNet
    displayName: Print Project Content
    condition: succeeded()
    continueOnError: true
    inputs:
      targetType: "inline"
      script: |
        # Define base directories and script locations
        $BaseDirectory = "$(Build.SourcesDirectory)"
        $BuildTemplatesDirectory = "$(BuildTemplateRepositoryFolder)"
        $PowerShellScriptsDirectory = "$(PowerShellScriptsDirectory)"

        # Construct the path to the primary script
        $ScriptName = "print-project-content"
        $ChildPath = ($BuildTemplatesDirectory, $PowerShellScriptsDirectory, "print-project-content", "$ScriptName.ps1" -join [IO.Path]::DirectorySeparatorChar)
        $ScriptPath = Join-Path $BaseDirectory -ChildPath $ChildPath

        # Define the script parameters
        $SourceDirectory = ("$(Build.SourcesDirectory)", "$(SelfRepositoryFolder)" -join [IO.Path]::DirectorySeparatorChar)
        $ProjectName = "$(ProjectName)"

        # Log the script path and variables for debugging purposes
        Write-Host "ScriptPath: $ScriptPath"
        Write-Host "SourceDirectory: $SourceDirectory"
        Write-Host "ProjectName: $ProjectName"

        # Execute the script with the necessary parameters
        # TODO: Convert to function, rename, and execute using function name (requires dot-sourcing the script)
        & $ScriptPath -SourceDirectory $SourceDirectory -ProjectName $ProjectName
      pwsh: true
